{% extends "default/base.html.twig" %}
{% block styles %}
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/css/select2.min.css" rel="stylesheet" />
    <style>
        .select2-container {
            min-width: 400px;
        }

        .select2-results__option {
            padding-right: 20px;
            vertical-align: middle;
        }
        .select2-results__option:before {
            content: "";
            display: inline-block;
            position: relative;
            height: 20px;
            width: 20px;
            border: 2px solid #e9e9e9;
            border-radius: 4px;
            background-color: #fff;
            margin-right: 20px;
            vertical-align: middle;
        }
        .select2-results__option[aria-selected=true]:before {
            content: "\f00c";
            color: #fff;
            background-color: #f77750;
            border: 0;
            display: inline-block;
            padding-left: 3px;
        }
        .select2-container--default .select2-results__option[aria-selected=true] {
            background-color: #fff;
        }
        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background-color: #eaeaeb;
            color: #272727;
        }
        .select2-container--default .select2-selection--multiple {
            margin-bottom: 10px;
        }
        .select2-container--default.select2-container--open.select2-container--below .select2-selection--multiple {
            border-radius: 4px;
        }
        .select2-container--default.select2-container--focus .select2-selection--multiple {
            border-color: #f77750;
            border-width: 2px;
        }
        .select2-container--default .select2-selection--multiple {
            border-width: 2px;
        }
        .select2-container--open .select2-dropdown--below {

            border-radius: 6px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);

        }

    </style>
{% endblock %}

{% block content %}

    <style>
        input[type='number'] {
            -moz-appearance:textfield;
        }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }
        fieldset {
            color: #191919;
        }
        .error-message {
            color: #cc0033;
            /*display: inline-block;*/
            font-size: 12px;
            line-height: 15px;
            margin: 5px 0 0;
        }
    </style>
    <div class="row mt-3">
        <div class="col-lg-12">
            <div class="ibox">
                <div class="ibox-title">
                    <h5>Добавление закупки</h5>

                </div>
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-lg-3">
                            <label>Год</label>
                            <select id="year-input" class="form-control m-b" >
                                <option>2020</option>
                                <option>2021</option>
                                <option>2022</option>
                                <option>2023</option>
                            </select>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <button id="filter-btn" type="button mr-3" class="btn">
                                <i class="fa fa-check">
                                    Отфильтровать
                                </i>
                            </button>
                            <button id="cancel-filter-btn" type="button" class="btn">
                                <i class="fa fa-close">
                                    Сбросить фильтр
                                </i>
                            </button>
                        </div>

                    </div>
                    <hr>
                    {{ form_start(form) }}

                    <div id="clusters" class="row">
                        {% for i in form.clusters %}
                            <div class="form-control col-lg-3 m-2">
                                <div class="row">
                                    <div class="col-lg-1">
                                        {{ form_widget(i) }}
                                    </div>
                                    <div class="col-lg-10">
                                        <h3>
                                            <b>Субъект РФ:</b> {{ i.vars.attr["data-region"] }}
                                        </h3>


                                    </div>
                                    <div class="col-lg-10">
                                        <hr>
                                        <b>Кластер:</b> {{ form_label(i) }} <br>
                                        <b>Год:</b> {{ i.vars.attr["data-year"] }} <br>

                                    </div>
                                </div>

                            </div>
                        {% endfor %}
                    </div>
                    {{ form_end(form) }}
                </div>
            </div>
        </div>

    </div>
    <div style="display: none">
        <input type="date" id="today" name="today_input">
    </div>

{% endblock %}

{% block scripts %}
    {#<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>#}
    {#<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>#}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/js/select2.min.js"></script>
    <script>
        $(document).ready(function(){
            let yearInput = $('#year-input');
            // let regionInput = $('#region-input');
            let filterBtn = $('#filter-btn');
            let cancelFilterBtn = $('#cancel-filter-btn');
            function filter() {
                cancelFilter();
                console.log('Отфильтровано');

                let _year = "data-year!=" + yearInput.val();
                let filtered_year = $('#clusters input['+_year+']');
                filtered_year.closest('.form-control').hide();


                // regionInput.val().each((elem) => {
                //     let _region = `data-region!=''`;
                //         // "data-region!='" + elem + "'";
                //     let filtered_region = $('#clusters input['+_region+']');
                //     filtered_region.closest('.form-control').hide();
                // });
                //
                // console.log(regionInput.val());
            }
            function cancelFilter() {
                console.log('фильтр сброшен');
                $('.form-control').show();

            }
            filterBtn.click((e) => {
                filter();
            });
            cancelFilterBtn.click((e) => {
                cancelFilter();
            });
            // $('.select2').select2({
            //     closeOnSelect : false,
            //     placeholder : "Placeholder",
            //     allowHtml: true,
            //     allowClear: true
            // });
        });
    </script>
{% endblock %}