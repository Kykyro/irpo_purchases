{% extends "admin/base.html.twig" %}

{% block content %}
<div class="row">
    <div class="col-sm-12">
        <div class="ibox">
            <div class="ibox-title">
                <h5>
                    Проверка карт готовности
                </h5>
            </div>
            <div class="ibox-content">
                {{ form_start(form) }}
                    {{ form_row(form.search) }}
                    <button class="btn btn-search" type="submit">
                        <i class="fa fa-search"></i>
                        Поиск
                    </button>
                {{ form_end(form) }}
                <table class="table table-bordered">
                    <thead>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>
                            Есть проверка?
                        </td>
                        <td>
                            Обновлять каждую неделю?
                        </td>
                    </thead>
                    <tbody>
                        {% for i in users %}
                            <tr>
                                <td>{{ i.getId() }}</td>
                                <td>{{ i.getUsername() }}</td>
                                <td>{{ i.getUserInfo().getEducationalOrganization() }}</td>
                                <td>
                                    {% if i.getReadinessMapChecks()|length == 0 %}
                                        <a href="{{ path('app_admin_readiness_map_check_create', {'id': i.getId()}) }}">
                                            <button class="btn btn-danger">
                                                <i class="fa fa-close"></i>
                                            </button>
                                        </a>
                                    {% else %}
                                        <button class="btn btn-primary">
                                            <i class="fa fa-check"></i>
                                        </button>
                                    {% endif %}
                                </td>

                                <td>
                                    {% if not i.getUserInfo().isReadinessMapChecksRefresh() %}
                                        <a href="{{ path('app_admin_readiness_map_check_refresh', {'id': i.getId()}) }}">
                                            <button class="btn btn-danger">
                                                <i class="fa fa-close"></i>
                                            </button>
                                        </a>
                                    {% else %}
                                        <a href="{{ path('app_admin_readiness_map_check_refresh', {'id': i.getId()}) }}">
                                            <button class="btn btn-primary">
                                                <i class="fa fa-check"></i>
                                            </button>
                                        </a>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="ibox-footer">
                <div class="navigation">
                    {{ knp_pagination_render(users, 'default/twitter_bootstrap_v3_pagination.html.twig') }}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}